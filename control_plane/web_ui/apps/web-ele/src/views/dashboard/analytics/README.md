# å¾…åŠå®¡æ ¸ä¸­å¿ƒ

## åŠŸèƒ½è¯´æ˜

è¿™ä¸ªé¡µé¢æ˜¯**é€šç”¨çš„å¾…åŠå®¡æ ¸ä¸­å¿ƒ**ï¼Œåˆ†ä¸ºä¸¤ä¸ª Tabï¼š
- **å¾…å¤„ç†**ï¼šç”¨æˆ·è‡ªå·±éœ€è¦å®Œæˆçš„ä»»åŠ¡ï¼ˆå¦‚ç­¾å­—ã€è¡¥å……ææ–™ç­‰ï¼‰ï¼Œ**ä¸åŒ…æ‹¬å®¡æ ¸ä»»åŠ¡**
- **å¾…å®¡æ ¸**ï¼šå®¡æ ¸äººå‘˜éœ€è¦å®¡æ ¸çš„ä¸šåŠ¡ç”³è¯·

## ä¸»è¦åŠŸèƒ½

### 1. ç»Ÿè®¡æ¦‚è§ˆ

æ˜¾ç¤ºäº”é¡¹å…³é”®ç»Ÿè®¡æ•°æ®ï¼š
- **å¾…å¤„ç†**ï¼šå½“å‰ç”¨æˆ·éœ€è¦å¤„ç†çš„ä»»åŠ¡æ•°é‡ï¼ˆä¸å«å®¡æ ¸ä»»åŠ¡ï¼‰
- **å¾…å®¡æ ¸**ï¼šå¾…å®¡æ ¸çš„ä¸šåŠ¡ç”³è¯·æ•°é‡
- **å®¡æ ¸ä¸­**ï¼šæ­£åœ¨å®¡æ ¸ä¸­çš„ä¸šåŠ¡æ•°é‡
- **ä»Šæ—¥å·²å¤„ç†**ï¼šä»Šå¤©å·²å¤„ç†çš„ä¸šåŠ¡æ•°é‡
- **ç´¯è®¡å·²å®Œæˆ**ï¼šå†å²ç´¯è®¡å®Œæˆçš„ä¸šåŠ¡æ•°é‡

### 2. Tab åˆ‡æ¢

#### **å¾…å¤„ç† Tab**
- **æ•°æ®æ¥æº**ï¼š`/api/workflow/task/page`
- **è¿‡æ»¤æ¡ä»¶**ï¼š
  - åªæŸ¥è¯¢åˆ†é…ç»™å½“å‰ç”¨æˆ·çš„ä»»åŠ¡ï¼ˆ`assigneeId = å½“å‰ç”¨æˆ·`ï¼‰
  - **æ’é™¤** `taskType = 'APPROVAL'` çš„å®¡æ‰¹ä»»åŠ¡
  - åªæ˜¾ç¤ºç”¨æˆ·éœ€è¦å®Œæˆçš„ä»»åŠ¡ï¼ˆç­¾å­—ã€æäº¤ã€ä¿®æ”¹ç­‰ï¼‰
- **æ˜¾ç¤ºå­—æ®µ**ï¼šä»»åŠ¡åç§°ã€ä»»åŠ¡ç±»å‹ã€ä»»åŠ¡çŠ¶æ€ã€ä¸šåŠ¡åç§°ã€åˆ›å»ºæ—¶é—´
- **æ“ä½œ**ï¼šæŸ¥çœ‹ã€è®¤é¢†ã€å®Œæˆ

#### **å¾…å®¡æ ¸ Tab**
- **æ•°æ®æ¥æº**ï¼š`/api/business/pending-approval`
- **è¿‡æ»¤æ¡ä»¶**ï¼šçŠ¶æ€ä¸º `PENDING_STAFF`ï¼ˆå¾…ä¸šåŠ¡å‘˜å¤„ç†ï¼‰çš„ä¸šåŠ¡
- **æ˜¾ç¤ºå­—æ®µ**ï¼š
  - ä¸šåŠ¡ç¼–å·
  - ä¸šåŠ¡åç§°
  - ä¸šåŠ¡ç±»å‹ï¼ˆä¸ªä½“æˆ·æ³¨å†Œã€ä¼ä¸šæ³¨å†Œç­‰ï¼‰
  - çŠ¶æ€ï¼ˆå¾…ä¸šåŠ¡å‘˜å¤„ç†ï¼‰
  - å½“å‰ç¯èŠ‚ï¼ˆèµ„æ–™åˆå®¡ã€ç­¾å­—å®¡æ ¸ç­‰ï¼‰
  - ç”³è¯·äºº
  - æäº¤æ—¶é—´
- **æ“ä½œ**ï¼šæŸ¥çœ‹ã€é€šè¿‡ã€é©³å›

### 3. æœç´¢ç­›é€‰

#### å¾…å¤„ç† Tab
- ä»»åŠ¡çŠ¶æ€ï¼ˆå¾…å¤„ç†ã€å·²è®¤é¢†ã€å·²å®Œæˆï¼‰

#### å¾…å®¡æ ¸ Tab
- ä¸šåŠ¡ç¼–å·ï¼ˆæ¨¡ç³Šæœç´¢ï¼‰
- ä¸šåŠ¡åç§°ï¼ˆæ¨¡ç³Šæœç´¢ï¼‰
- ä¸šåŠ¡ç±»å‹ï¼ˆä¸‹æ‹‰é€‰æ‹©ï¼‰

### 4. çº¢ç‚¹æç¤º

Tab æ ‡ç­¾ä¸Šä¼šæ˜¾ç¤ºçº¢è‰²å¾½ç« ï¼š
- **æœ‰æ•°æ®**ï¼šæ˜¾ç¤ºçº¢è‰²å¾½ç«  + æ•°é‡ï¼ˆå¦‚ `ğŸ”´ 5`ï¼‰
- **æ— æ•°æ®**ï¼šæ˜¾ç¤ºç°è‰²"æ— "å­—æ ·
- **è„‰å†²åŠ¨ç”»**ï¼šå¾½ç« æœ‰å‘¼å¸æ•ˆæœï¼Œæ›´é†’ç›®

## API æ¥å£

### åç«¯æ¥å£

#### 1. è·å–å¾…å¤„ç†ä»»åŠ¡åˆ—è¡¨
```
GET /api/workflow/task/page
```

**è¯·æ±‚å‚æ•°**ï¼š
- `pageNum`ï¼šé¡µç ï¼ˆé»˜è®¤ 1ï¼‰
- `pageSize`ï¼šæ¯é¡µæ•°é‡ï¼ˆé»˜è®¤ 10ï¼‰
- `assigneeId`ï¼šå¤„ç†äººIDï¼ˆç”¨äºè¿‡æ»¤å½“å‰ç”¨æˆ·çš„ä»»åŠ¡ï¼‰
- `taskStatus`ï¼šä»»åŠ¡çŠ¶æ€ï¼ˆå¯é€‰ï¼šPENDINGã€CLAIMEDã€COMPLETEDï¼‰
- `taskType`ï¼šä»»åŠ¡ç±»å‹ï¼ˆå¯é€‰ï¼Œå‰ç«¯ä¼šè¿‡æ»¤æ‰ APPROVALï¼‰

**å‰ç«¯è¿‡æ»¤é€»è¾‘**ï¼š
```typescript
// æ’é™¤å®¡æ‰¹ç±»å‹çš„ä»»åŠ¡
const filteredRecords = allRecords.filter((task: any) => task.taskType !== 'APPROVAL')
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "success": true,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "records": [
      {
        "id": "xxx",
        "taskType": "SIGN",
        "taskName": "ç”¨æˆ·ç­¾å­—",
        "taskStatus": "PENDING",
        "businessId": "xxx",
        "businessName": "è¯šä¿¡å•†è´¸-å¼€åŠä¸ªä½“å·¥å•†æˆ·",
        "assigneeId": "user123",
        "createTime": "2025-10-29T16:09:53"
      }
    ],
    "total": 5,
    "current": 1,
    "size": 10
  }
}
```

#### 2. è·å–å¾…å®¡æ ¸åˆ—è¡¨
```
GET /api/business/pending-approval
```

**è¯·æ±‚å‚æ•°**ï¼š
- `pageNum`ï¼šé¡µç ï¼ˆé»˜è®¤ 1ï¼‰
- `pageSize`ï¼šæ¯é¡µæ•°é‡ï¼ˆé»˜è®¤ 10ï¼‰
- `businessNo`ï¼šä¸šåŠ¡ç¼–å·ï¼ˆå¯é€‰ï¼‰
- `businessName`ï¼šä¸šåŠ¡åç§°ï¼ˆå¯é€‰ï¼‰
- `businessType`ï¼šä¸šåŠ¡ç±»å‹ï¼ˆå¯é€‰ï¼‰

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "success": true,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "records": [
      {
        "id": "xxx",
        "businessNo": "GETIHU_REGISTER_202510290001",
        "businessName": "è¯šä¿¡å•†è´¸-å¼€åŠä¸ªä½“å·¥å•†æˆ·",
        "businessType": "GETIHU_REGISTER",
        "businessTypeName": "ä¸ªä½“æˆ·æ³¨å†Œ",
        "status": "PENDING_STAFF",
        "statusName": "å¾…ä¸šåŠ¡å‘˜å¤„ç†",
        "currentStep": "èµ„æ–™åˆå®¡",
        "createUserName": "å¼ ä¸‰",
        "submitTime": "2025-10-29T16:09:53"
      }
    ],
    "total": 10,
    "current": 1,
    "size": 10
  }
}
```

#### 3. å®¡æ ¸é€šè¿‡ï¼ˆé€šç”¨æ¥å£ï¼‰âœ…
```
POST /api/business/{businessId}/approve
```

**è¯·æ±‚ä½“**ï¼š
```json
{
  "comment": "å®¡æ ¸é€šè¿‡"
}
```

**åŠŸèƒ½è¯´æ˜**ï¼š
- æ ¹æ®ä¸šåŠ¡ç±»å‹è‡ªåŠ¨è·¯ç”±åˆ°å¯¹åº”çš„å®¡æ ¸é€»è¾‘
- æ”¯æŒä¸ªä½“æˆ·æ³¨å†Œï¼ˆ`GETIHU_REGISTER`ï¼‰
- å…¶ä»–ä¸šåŠ¡ç±»å‹å¯æ‰©å±•

#### 4. å®¡æ ¸é©³å›ï¼ˆé€šç”¨æ¥å£ï¼‰âœ…
```
POST /api/business/{businessId}/reject
```

**Query å‚æ•°**ï¼š
- `reason`ï¼šé©³å›åŸå› ï¼ˆå¿…å¡«ï¼‰

**åŠŸèƒ½è¯´æ˜**ï¼š
- æ ¹æ®ä¸šåŠ¡ç±»å‹è‡ªåŠ¨è·¯ç”±åˆ°å¯¹åº”çš„é©³å›é€»è¾‘
- æ”¯æŒä¸ªä½“æˆ·æ³¨å†Œï¼ˆ`GETIHU_REGISTER`ï¼‰
- å…¶ä»–ä¸šåŠ¡ç±»å‹å¯æ‰©å±•

## ä¸šåŠ¡æµç¨‹

### ä¸ªä½“æˆ·æ³¨å†Œå®¡æ ¸æµç¨‹

```
ç”¨æˆ·æäº¤
  â†“
AI é¢„å®¡ï¼ˆè‡ªåŠ¨ï¼‰
  â†“ é€šè¿‡
èµ„æ–™åˆå®¡ï¼ˆäººå·¥ï¼‰ â† å¾…åŠå®¡æ ¸ä¸­å¿ƒæ˜¾ç¤º
  â†“ é€šè¿‡
ç­¾å­—å®¡æ ¸ï¼ˆäººå·¥ï¼‰ â† å¾…åŠå®¡æ ¸ä¸­å¿ƒæ˜¾ç¤º
  â†“ é€šè¿‡
å†…ç½‘å®¡æ ¸ï¼ˆæœ€ç»ˆå®¡æ ¸ï¼‰â† å¾…åŠå®¡æ ¸ä¸­å¿ƒæ˜¾ç¤º
  â†“ é€šè¿‡
å‘è¯é€šçŸ¥
  â†“
åŠç»“æˆåŠŸ
```

## çŠ¶æ€è¯´æ˜

### ä»»åŠ¡ç±»å‹ï¼ˆ`taskType`ï¼‰

| ä»»åŠ¡ç±»å‹   | è¯´æ˜                         | æ˜¯å¦åœ¨å¾…å¤„ç†æ˜¾ç¤º |
| ---------- | ---------------------------- | ---------------- |
| `APPROVAL` | å®¡æ‰¹ä»»åŠ¡ï¼ˆéœ€è¦å®¡æ ¸äººå‘˜å¤„ç†ï¼‰ | âŒ ä¸æ˜¾ç¤º         |
| `SIGN`     | ç­¾å­—ä»»åŠ¡ï¼ˆéœ€è¦ç”¨æˆ·ç­¾å­—ç¡®è®¤ï¼‰ | âœ… æ˜¾ç¤º           |
| `SUBMIT`   | æäº¤ä»»åŠ¡ï¼ˆéœ€è¦ç”¨æˆ·æäº¤ææ–™ï¼‰ | âœ… æ˜¾ç¤º           |
| `MODIFY`   | ä¿®æ”¹ä»»åŠ¡ï¼ˆéœ€è¦ç”¨æˆ·ä¿®æ”¹èµ„æ–™ï¼‰ | âœ… æ˜¾ç¤º           |

**é‡è¦**ï¼š
- **å¾…å¤„ç† Tab**ï¼šåªæ˜¾ç¤º `taskType â‰  'APPROVAL'` çš„ä»»åŠ¡ï¼ˆç”¨æˆ·è‡ªå·±çš„ä»»åŠ¡ï¼‰
- **å¾…å®¡æ ¸ Tab**ï¼šæ˜¾ç¤ºæ‰€æœ‰å¾…å®¡æ ¸çš„ä¸šåŠ¡ç”³è¯·ï¼ˆä¸åŒºåˆ† taskTypeï¼‰

### ä¸šåŠ¡çŠ¶æ€ï¼ˆ`status`ï¼‰

| çŠ¶æ€ä»£ç         | çŠ¶æ€åç§°     | è¯´æ˜                             |
| --------------- | ------------ | -------------------------------- |
| `DRAFT`         | è‰ç¨¿         | åˆå§‹çŠ¶æ€ï¼Œå°šæœªæäº¤               |
| `PENDING_USER`  | å¾…ç”¨æˆ·å¤„ç†   | éœ€è¦ç”¨æˆ·ç­¾å­—ã€è¡¥æ­£ææ–™ç­‰         |
| `PENDING_STAFF` | å¾…ä¸šåŠ¡å‘˜å¤„ç† | å¾…ä¸šåŠ¡å‘˜å®¡æ ¸ï¼ˆæ˜¾ç¤ºåœ¨å¾…å®¡æ ¸ Tabï¼‰ |
| `REJECTED`      | å·²é©³å›       | å®¡æ ¸ä¸é€šè¿‡                       |
| `COMPLETED`     | å·²åŠç»“       | æµç¨‹å®Œæˆ                         |
| `CANCELLED`     | å·²å–æ¶ˆ       | ä¸šåŠ¡å–æ¶ˆ                         |

**è¯´æ˜**ï¼š
- AI é¢„å®¡å’Œå†…ç½‘å®¡æ ¸åœ¨åå°æ‰§è¡Œï¼Œä¸æ”¹å˜ä¸šåŠ¡çŠ¶æ€
- ç”¨æˆ·æäº¤åï¼ŒAI é¢„å®¡é€šè¿‡è‡ªåŠ¨è¿›å…¥ `PENDING_STAFF`
- ç”¨æˆ·ç­¾å­—åï¼Œå†…ç½‘å®¡æ ¸é€šè¿‡è‡ªåŠ¨è¿›å…¥ `COMPLETED`

## æ‰©å±•è¯´æ˜

### æ·»åŠ æ–°çš„ä¸šåŠ¡ç±»å‹

âœ… **ç°åœ¨ä½¿ç”¨é€šç”¨å®¡æ ¸æ¥å£**ï¼Œæ·»åŠ æ–°ä¸šåŠ¡ç±»å‹éå¸¸ç®€å•ï¼š

#### 1. **åç«¯æ‰©å±•**ï¼ˆåœ¨å¯¹åº”çš„ä¸šåŠ¡ Service ä¸­å®ç° approve å’Œ reject æ–¹æ³•ï¼‰

```java
// ç¤ºä¾‹ï¼šä¼ä¸šæ³¨å†Œ Service
@Service
public class EnterpriseRegisterService {
  
  @Transactional(rollbackFor = Exception.class)
  public Result<String> approve(String businessId, String comment) {
    // å®ç°ä¼ä¸šæ³¨å†Œå®¡æ ¸é€»è¾‘
    return Result.success("å®¡æ ¸é€šè¿‡");
  }
  
  @Transactional(rollbackFor = Exception.class)
  public Result<String> reject(String businessId, String reason) {
    // å®ç°ä¼ä¸šæ³¨å†Œé©³å›é€»è¾‘
    return Result.success("å®¡æ ¸é©³å›");
  }
}
```

#### 2. **åœ¨ BizBusinessService ä¸­æ·»åŠ è·¯ç”±**

```java
@Autowired(required = false)
private EnterpriseRegisterService enterpriseRegisterService;

public Result<String> approve(String businessId, String comment) {
  // ...
  if (BusinessTypeConstants.ENTERPRISE_REGISTER.equals(businessType)) {
    return enterpriseRegisterService.approve(businessId, comment);
  }
  // ...
}

public Result<String> reject(String businessId, String reason) {
  // ...
  if (BusinessTypeConstants.ENTERPRISE_REGISTER.equals(businessType)) {
    return enterpriseRegisterService.reject(businessId, reason);
  }
  // ...
}
```

#### 3. **å‰ç«¯æ— éœ€ä¿®æ”¹** âœ…

å‰ç«¯å·²ç»ä½¿ç”¨é€šç”¨æ¥å£ï¼Œæ–°å¢ä¸šåŠ¡ç±»å‹å**è‡ªåŠ¨æ”¯æŒ**ï¼

```typescript
// é€šç”¨å®¡æ ¸æ¥å£ï¼Œè‡ªåŠ¨æ”¯æŒæ‰€æœ‰ä¸šåŠ¡ç±»å‹
await requestClient.post(`/business/${row.id}/approve`, {
  comment: result.value || 'å®¡æ ¸é€šè¿‡',
})

await requestClient.post(`/business/${row.id}/reject`, null, {
  params: { reason: result.value },
})
```

## æƒé™æ§åˆ¶

ç›®å‰è¯¥é¡µé¢**æœªåšæƒé™é™åˆ¶**ï¼Œæ‰€æœ‰ç™»å½•ç”¨æˆ·éƒ½å¯ä»¥è®¿é—®ã€‚

åç»­å¯ä»¥æ·»åŠ æƒé™æ§åˆ¶ï¼š
- åªæœ‰å®¡æ ¸äººå‘˜æ‰èƒ½è®¿é—®
- ä¸åŒè§’è‰²åªèƒ½å®¡æ ¸ç‰¹å®šç±»å‹çš„ä¸šåŠ¡

## è®¿é—®è·¯å¾„

- **å¼€å‘ç¯å¢ƒ**ï¼š`http://localhost:5173/dashboard/analytics`
- **ç”Ÿäº§ç¯å¢ƒ**ï¼šæ ¹æ®å®é™…éƒ¨ç½²è·¯å¾„è®¿é—®

---

**æœ€åæ›´æ–°**ï¼š2025-10-29  
**ç‰ˆæœ¬**ï¼šv1.0

